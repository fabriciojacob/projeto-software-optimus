<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head>

</h:head>
<body>
	<h:form id="frmCadTipoProduto">
		<br />
		<h3 style="margin-top: 0">CADASTRO DO TIPO DE PRODUTO</h3>
		<div align="left">

			<p:commandButton value="Novo"
				actionListener="#{tipoProdutoBean.novo}" ajax="grid" />

			<p:commandButton value="Salvar" disabled="#{tipoProdutoBean.sal}"
				actionListener="#{tipoProdutoBean.salvar}" ajax="grid"
				update="dialog2" />

			<p:commandButton value="Alterar" disabled="#{tipoProdutoBean.alt}"
				actionListener="#{tipoProdutoBean.alterar}" ajax="grid" />

			<p:commandButton value="Excluir" disabled="#{tipoProdutoBean.rem}"
				actionListener="#{tipoProdutoBean.remover}" ajax="grid" />

			<p:commandButton id="consulta" value="Consultar" type="button"
				ajax="dialog, grid" onclick="PF('dlg1').show();"
				actionListener="#{tipoProdutoBean.cancelar}" />

			<p:commandButton value="Cancelar"
				actionListener="#{tipoProdutoBean.cancelar}" ajax="grid" />
			<p:messages id="messages" showDetail="true" autoUpdate="true"
				closable="true" />

			<h:panelGrid id="grid" columns="2" columnClasses="label, value">
			
					Código do Tipo de Produto:
					<p:inputText id="idTip" disabled="true"
					value="#{tipoProdutoBean.tipo.idTipoProd}" />
		
					Descrição da Grade:
					<p:inputText id="descTip" value="#{tipoProdutoBean.tipo.descricao}"
					size="40" disabled="#{tipoProdutoBean.desc}" />
			</h:panelGrid>

			<p:commandButton id="vincVigencia"
				value="Vigência do Tipo de Produto" type="button"
				update="gridincEdi2" disabled="#{tipoProdutoBean.vig}"
				onclick="PF('dlg2').show();" />

			<h:panelGrid id="gridVigTipo" columns="1">
				<p:blockUI block="gridVigTipo" trigger="vincVigencia" />
				<p:dataTable id="listaVigTipoProd"
					value="#{tipoProdutoBean.listaTbGov}" var="listatbGov"
					paginator="true" rows="8">

					<p:column headerText="Código da Vigência">
						<h:outputText value="#{listatbGov.idCodGov}" />
					</p:column>

					<p:column headerText="Vigência">
						<h:outputText value="#{listatbGov.vigencia}">
							<f:convertDateTime type="date" dateStyle="medium" />
						</h:outputText>
					</p:column>

					<p:column headerText="Código Ncm">
						<h:outputText value="#{listatbGov.ncm}" />
					</p:column>

					<p:column headerText="Alíquota Entrada Pis">
						<h:outputText value="#{listatbGov.entradaPis}" />
					</p:column>

					<p:column headerText="Alíquota Entrada Cofins">
						<h:outputText value="#{listatbGov.entradaCofins}" />
					</p:column>

					<p:column headerText="Alíquota Saída Pis">
						<h:outputText value="#{listatbGov.saidaPis}" />
					</p:column>

					<p:column headerText="Alíquota Saída Cofins">
						<h:outputText value="#{listatbGov.saidaCofins}" />
					</p:column>

					<p:column headerText="Alíquota Ipi">
						<h:outputLabel value="#{listatbGov.aliquotaIpi}" />
					</p:column>

					<p:column headerText="Tipo do Item">
						<h:outputLabel value="#{listatbGov.tipoItem}" />
					</p:column>

					<p:column headerText="Editar">
						<p:commandLink id="linkEditaVig" value="Editar" ajax="dialog"
							action="#{tipoProdutoBean.editarVigTip}" update="listatbGov">
							<f:setPropertyActionListener value="#{listatbGov.idCodGov}"
								target="#{tipoProdutoBean.idVig}" />
						</p:commandLink>
					</p:column>

					<p:column headerText="Excluir">
						<p:commandLink id="linkExcluiVig" value="Excluir" ajax="dialog"
							action="#{tipoProdutoBean.excluirVigTip}" update="listatbGov">
							<f:setPropertyActionListener value="#{listatbGov.idCodGov}"
								target="#{tipoProdutoBean.idVig}" />
						</p:commandLink>
					</p:column>

				</p:dataTable>
				<p:blockUI block="listaVigTipoProd" trigger="listaVigTipoProd">
        				LOADING<br />
					<p:graphicImage name="ajaxloader.gif" />
				</p:blockUI>
			</h:panelGrid>

			<p:dialog id="dialog1" header="Consulta" widgetVar="dlg1"
				modal="true" height="300" width="430">

				<div align="right">
					<h:panelGrid columns="1">
						<p:commandButton value="Pesquisar"
							actionListener="#{tipoProdutoBean.buscarTipo}" update="gridData">
						</p:commandButton>
					</h:panelGrid>
				</div>
				<h:panelGrid columns="3" columnClasses="label" cellspacing="3">
					<p:inputText id="texto" value="#{tipoProdutoBean.busca}" size="40" />

					<p:selectOneMenu id="fConsult" value="#{tipoProdutoBean.filtro}">/>
						<f:selectItem itemLabel="Selecione uma Opção" />
						<f:selectItem itemLabel="Código" itemValue="id" />
						<f:selectItem itemLabel="Descrição" itemValue="desc" />
					</p:selectOneMenu>

				</h:panelGrid>
				<h:panelGrid id="gridData" columns="1" columnClasses="label, value">
					<p:blockUI block="gridData" trigger="consulta" />
					<p:dataTable id="data" value="#{tipoProdutoBean.listaTipoProduto}"
						paginator="true" rows="6" var="tipoProd"
						rowKey="tipoProd.idTipoProd">

						<p:column headerText="Código do Tipo de Produto">
							<h:outputText value="#{tipoProd.idTipoProd}" />
						</p:column>

						<p:column headerText="Descrição">
							<h:outputText value="#{tipoProd.descricao}" />
						</p:column>

						<p:column headerText="Selecionar">
							<p:commandLink id="link" value="Editar"
								ajax="grid, dialog1, gridVigTipo"
								action="#{tipoProdutoBean.editTipo}">
								<f:setPropertyActionListener value="#{tipoProd.idTipoProd}"
									target="#{tipoProdutoBean.id}" />
							</p:commandLink>
						</p:column>
					</p:dataTable>
					<p:blockUI block="data" trigger="data">
        				LOADING<br />
						<p:graphicImage name="ajaxloader.gif" />
					</p:blockUI>
				</h:panelGrid>
			</p:dialog>

			<p:dialog id="dialog2" header="Inclusão e Edição da Vigência"
				widgetVar="dlg2" modal="true" height="320" width="400">

				<h:panelGrid id="gridincEdi2" columns="1"
					columnClasses="label, value">

					<h:panelGrid columns="2">
					
					Código da Vigência do Tipo:
					<p:inputText id="idTipoProdVig" disabled="true"
							value="#{tipoProdutoBean.tbGov.idCodGov}" />
							
					Ncm:
					<h:panelGrid id="textoNcm" columns="2">
							<p:inputText id="ncm" value="#{tipoProdutoBean.tbGov.ncm}"
								size="15" disabled="true" />

							<p:commandButton id="vincularNcm" value="Busca NCM"
								onclick="PF('dlg5').show();" update="ncm" />
						</h:panelGrid>
					Vigência:
					<p:calendar id="tipVigencia" size="29"
							value="#{tipoProdutoBean.tbGov.vigencia}" effect="fold" />	
				
					Alíquota Entrada Pis:
					<p:selectOneMenu id="aliqEntPis" style="width:200px;"
							value="#{tipoProdutoBean.tbGov.entradaPis}">
							<f:selectItem itemLabel="Selecione uma alíquota" />
							<f:selectItems value="#{tipoProdutoBean.listaAliqPisCofins}"
								var="listAliqPisCofins" itemValue="#{listAliqPisCofins}"
								itemLabel="#{listAliqPisCofins.idAliq} - #{listAliqPisCofins.aliquota}" />
						</p:selectOneMenu>
						
					Alíquota Entrada Cofins:
					<p:selectOneMenu id="aliqEntCof" style="width:200px;"
							value="#{tipoProdutoBean.tbGov.entradaCofins}">
							<f:selectItem itemLabel="Selecione uma alíquota" />
							<f:selectItems value="#{tipoProdutoBean.listaAliqPisCofins}"
								var="listAliqPisCofins2" itemValue="#{listAliqPisCofins2}"
								itemLabel="#{listAliqPisCofins2.idAliq} - #{listAliqPisCofins2.aliquota}" />
						</p:selectOneMenu>
						
					Alíquota Saída Pis:
					<p:selectOneMenu id="aliqSaiPis" style="width:200px;"
							value="#{tipoProdutoBean.tbGov.saidaPis}">
							<f:selectItem itemLabel="Selecione uma alíquota" />
							<f:selectItems value="#{tipoProdutoBean.listaAliqPisCofins}"
								var="listAliqPisCofins3" itemValue="#{listAliqPisCofins3}"
								itemLabel="#{listAliqPisCofins3.idAliq} - #{listAliqPisCofins3.aliquota}" />
						</p:selectOneMenu>
						
					Alíquota Saída Cofins:
					<p:selectOneMenu id="aliqSaiCo" style="width:200px;"
							value="#{tipoProdutoBean.tbGov.saidaCofins}">
							<f:selectItem itemLabel="Selecione uma alíquota" />
							<f:selectItems value="#{tipoProdutoBean.listaAliqPisCofins}"
								var="listAliqPisCofins4" itemValue="#{listAliqPisCofins4}"
								itemLabel="#{listAliqPisCofins4.idAliq} - #{listAliqPisCofins4.aliquota}" />
						</p:selectOneMenu>
						
					Alíquota IPI:
					<p:selectOneMenu id="aliqIpi" style="width:200px;"
							value="#{tipoProdutoBean.tbGov.aliquotaIpi}">
							<f:selectItem itemLabel="Selecione uma alíquota" />
							<f:selectItems value="#{tipoProdutoBean.listaAliqIpi}"
								var="listAliqIpi" itemValue="#{listAliqIpi}"
								itemLabel="#{listAliqIpi.idAliq} - #{listAliqIpi.aliquota}" />
						</p:selectOneMenu>						
						
					Tipo Item:
					<p:selectOneMenu id="tipoProd"
							value='#{tipoProdutoBean.tbGov.tipoItem}' style="width:200px;">
							<f:selectItem itemLabel=" Selecione
							tipo do item" />
							<f:selectItem itemLabel="00 – Mercadoria para Revenda"
								itemValue="00 - Mercadoria para Revenda" />
							<f:selectItem itemLabel="01 – Matéria-Prima"
								itemValue="01 – Matéria-Prima" />
							<f:selectItem itemLabel="02 – Embalagem"
								itemValue="02 – Embalagem" />
							<f:selectItem itemLabel="03 – Produto em Processo"
								itemValue="03 – Produto em Processo" />
							<f:selectItem itemLabel="04 – Produto Acabado"
								itemValue="04 – Produto Acabado" />
							<f:selectItem itemLabel="05 – Subproduto"
								itemValue="05 – Subproduto" />
							<f:selectItem itemLabel="06 – Produto Intermediário"
								itemValue="06 – Produto Intermediário" />
							<f:selectItem itemLabel="07 – Material de Uso e Consumo"
								itemValue="07 – Material de Uso e Consumo" />
							<f:selectItem itemLabel="08 – Ativo Imobilizado"
								itemValue="08 – Ativo Imobilizado" />
							<f:selectItem itemLabel="09 – Serviços" itemValue="09 – Serviços" />
							<f:selectItem itemLabel="10 – Outros insumos"
								itemValue="10 – Outros insumos" />
							<f:selectItem itemLabel="99 – Outras" itemValue="99 – Outras" />
						</p:selectOneMenu>

					</h:panelGrid>

				</h:panelGrid>
				<p:commandButton value="Incluir"
					actionListener="#{tipoProdutoBean.incluirTipoVig}"
					update="listaVigTipoProd, gridincEdi2" />
			</p:dialog>

			<p:dialog id="dialog5" header="Busca NCM" widgetVar="dlg5"
				modal="true" height="400" width="750">

				<div align="right">
					<h:panelGrid columns="1">
						<p:commandButton value="Buscar" id="bus"
							actionListener="#{tipoProdutoBean.buscarNcm}"
							update="gridDataNcm">
						</p:commandButton>
					</h:panelGrid>
				</div>
				<h:panelGrid columns="3" columnClasses="label" cellspacing="3">
					<p:inputText id="texto2" value="#{tipoProdutoBean.busca}" size="40" />

					<p:selectOneMenu id="filtroConsultaNcm"
						value="#{tipoProdutoBean.filtro}">/>
						<f:selectItem itemLabel="Selecione uma Opção" />
						<f:selectItem itemLabel="Código do NCM" itemValue="codNcm" />
						<f:selectItem itemLabel="Descrição do NCM" itemValue="descNcm" />
						<f:selectItem itemLabel="Descrição da NatRec" itemValue="descNat" />
						<f:selectItem itemLabel="Código da NatRec" itemValue="codNat" />
						<f:selectItem itemLabel="Descrição Tabela" itemValue="codNat" />
					</p:selectOneMenu>

				</h:panelGrid>
				<h:panelGrid id="gridDataNcm" columns="1"
					columnClasses="label, value">
					<p:blockUI block="gridDataNcm" trigger="bus" />
					<p:dataTable id="dataNcm" value="#{tipoProdutoBean.listaNcm}"
						paginator="true" rows="10" var="listNcm" rowKey="tipoProd.idNcm">

						<p:column headerText="Código do NCM">
							<h:outputText value="#{tlistNcm.idNcm}" />
						</p:column>

						<p:column headerText="NCM">
							<h:outputText value="#{listNcm.ncm}" />
						</p:column>

						<p:column headerText="Descricao do NCM">
							<h:outputText value="#{listNcm.descricaoNcm}" />
						</p:column>

						<p:column headerText="Natureza da Receita">
							<h:outputText value="#{listNcm.natRec}" />
						</p:column>
						
						<p:column headerText="Descrição da Tabela">
							<h:outputText value="#{listNcm.natRec}" />
						</p:column>

						<p:column headerText="Selecionar">
							<p:commandLink id="link" value="Vincular" update="textoNcm"
								action="#{tipoProdutoBean.vincularNcm}">
								<f:setPropertyActionListener value="#{tipoProd.idNcm}"
									target="#{tipoProdutoBean.idNcm}" />
							</p:commandLink>
						</p:column>
					</p:dataTable>
					<p:blockUI block="dataNcm" trigger="dataNcm">
        				LOADING<br />
						<p:graphicImage name="ajaxloader.gif" />
					</p:blockUI>
				</h:panelGrid>

			</p:dialog>

		</div>
	</h:form>
</body>
</html>
